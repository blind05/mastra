---
title: "Memory Scope Defaults | Migration Guide"
description: "Learn how to migrate from thread-scoped to resource-scoped memory defaults in Mastra."
---

## Overview

As of `@mastra/memory@0.16.0` and `@mastra/core@0.22.0`, the default memory scope for both **working memory** and **semantic recall** has changed from `'thread'` to `'resource'`.

## What changed

### Before

- Working memory defaulted to `scope: 'thread'` (isolated per conversation)
- Semantic recall defaulted to `scope: 'thread'` (search within current conversation only)

### After

- Working memory defaults to `scope: 'resource'` (persists across all user conversations)
- Semantic recall defaults to `scope: 'resource'` (search across all user conversations)

## Why this change?

This change was made because:

1. **Better user experience**: Most applications want to remember user information across conversations, not just within a single thread
2. **More intuitive default**: Users expect AI agents to "remember" them, which requires resource-scoped memory
3. **Alignment with common use cases**: The majority of production applications use resource-scoped memory

## Migration paths

Choose the migration path that fits your needs:

### Keep using thread-scoped memory

If you want to maintain the old behavior where memory is isolated per conversation thread, explicitly set `scope: 'thread'` in your memory configuration:

```typescript showLineNumbers copy
import { Memory } from '@mastra/memory';
import { LibSQLStore } from '@mastra/libsql';

const memory = new Memory({
  storage: new LibSQLStore({ url: 'file:local.db' }),
  options: {
    workingMemory: {
      enabled: true,
      scope: 'thread', // Explicitly set to thread-scoped
      template: `# User Profile
- **Name**: 
- **Interests**: 
`,
    },
    semanticRecall: {
      topK: 3,
      scope: 'thread', // Explicitly set to thread-scoped
    },
  },
});
```

> No further changes required.

### Upgrade to resource-scoped memory

If you want to adopt the new default behavior where memory persists across all conversations for the same user, you can optionally remove explicit `scope: 'resource'` declarations:

**Before:**
```typescript showLineNumbers copy
const memory = new Memory({
  storage,
  options: {
    workingMemory: {
      enabled: true,
      scope: 'resource', // Explicit declaration
      template: `# User Profile
- **Name**: 
- **Interests**: 
`,
    },
    semanticRecall: {
      topK: 3,
      scope: 'resource', // Explicit declaration
    },
  },
});
```

**After:**
```typescript showLineNumbers copy
const memory = new Memory({
  storage,
  options: {
    workingMemory: {
      enabled: true,
      // scope: 'resource' is now the default
      template: `# User Profile
- **Name**: 
- **Interests**: 
`,
    },
    semanticRecall: {
      topK: 3,
      // scope: 'resource' is now the default
    },
  },
});
```
